name: 'Logic App Standard Release'

trigger: none
     
variables:
  Artifacts.Location.Deploy.Bicep: $(System.DefaultWorkingDirectory)/deploy/bicep
  Artifacts.Location.Deploy.Scripts: $(System.DefaultWorkingDirectory)/deploy/scripts
  Artifacts.Location.Source: $(System.DefaultWorkingDirectory)/src

stages:
- stage: Sandbox
  displayName: Sandbox
  environment: Sandbox
  variables:
    - template: ../lib/environment/sandbox.yml
    - template: ../lib/general/azure.yml
  jobs: 
  - template: templates/logic-app-standard/release_stageSteps.yml
    parameters:
      azureServiceConnection: 'Visual Studio Enterprise-abonnement – MPN'
      location: '$(Environment.Region.Primary)'
      environment: '$(Environment.ShortName)'
      resourceGroupName: '$(ResourceGroup.LogicAppStandard)'
      
- stage: DEV
  displayName: DEV
  environment: DEV
  dependsOn: [Sandbox]
  condition: and(ne(variables['Build.Reason'], 'PullRequest'), succeeded())
  variables:
    - template: ../lib/environment/dev.yml
    - template: ../lib/general/azure.yml
  jobs: 
  - template: templates/logic-app-standard/release_stageSteps.yml
    parameters:
      azureServiceConnection: 'Visual Studio Enterprise-abonnement – MPN'
      location: '$(Environment.Region.Primary)'
      environment: '$(Environment.ShortName)'
      resourceGroupName: '$(ResourceGroup.LogicAppStandard)'